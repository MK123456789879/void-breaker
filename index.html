<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Void Breaker</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            color: #0f0;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        
        #gameCanvas {
            border: 2px solid #333;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            background-color: #000;
        }

        #ui-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
            width: 100%;
        }

        #progress-bar {
            width: 300px;
            height: 20px;
            border: 2px solid #0f0;
            margin: 20px auto;
            display: block;
        }

        #progress-bar-fill {
            height: 100%;
            background-color: #0f0;
            width: 0%;
            transition: width 0.2s;
        }

        .blink {
            animation: blinker 1s linear infinite;
        }

        @keyframes blinker {
            50% { opacity: 0; }
        }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div id="ui-layer">
        <h2 id="status-text">INITIALIZING...</h2>
        <div id="progress-bar">
            <div id="progress-bar-fill"></div>
        </div>
    </div>

<script>
    // --- 1. INSTELLINGEN ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 800;
    canvas.height = 600;

    // JOUW URL
const REPO_URL = '.';
    let gameActive = false;

    // --- 2. ASSETS ---
    const assetsToLoad = {
        images: [
             // { name: 'hero', url: `${REPO_URL}/assets/img/hero_straight.png` } 
        ],
        audio: [
            { name: 'voice_pre', url: `${REPO_URL}/assets/audio/voice/pre_score.mp3` },
            { name: 'voice_post', url: `${REPO_URL}/assets/audio/voice/post_score.mp3` },
            { name: 'music_menu', url: `${REPO_URL}/assets/audio/music/music_menu.mp3` }
        ]
    };

    let loadedCount = 0;
    let totalAssets = (assetsToLoad.images.length + assetsToLoad.audio.length) || 1; 
    const assets = { img: {}, audio: {} };

    // --- 3. LADEN ---
    function init() {
        console.log("Start laden...");
        
        if (assetsToLoad.images.length === 0 && assetsToLoad.audio.length === 0) {
            finishLoading();
            return;
        }

        // Audio laden (NU MET FIX!)
        assetsToLoad.audio.forEach(item => {
            const aud = new Audio();
            aud.src = item.url;
            aud.oncanplaythrough = () => {
                // HIER ZAT DE FOUT: We moeten hem opslaan!
                assets.audio[item.name] = aud; 
                handleAssetLoaded();
            };
            aud.onerror = () => {
                console.warn("Kon audio niet vinden: " + item.url);
                handleAssetLoaded(); 
            };
            aud.load();
        });

        // Plaatjes laden
        assetsToLoad.images.forEach(item => {
            const img = new Image();
            img.src = item.url;
            img.onload = () => {
                assets.img[item.name] = img;
                handleAssetLoaded();
            };
            img.onerror = () => handleAssetLoaded();
        });
        
        requestAnimationFrame(gameLoop);
    }

    function handleAssetLoaded() {
        loadedCount++;
        const pct = Math.floor((loadedCount / totalAssets) * 100);
        document.getElementById('progress-bar-fill').style.width = pct + '%';
        document.getElementById('status-text').innerText = `SYSTEM LOADING... ${pct}%`;

        if (loadedCount >= totalAssets) {
            finishLoading();
        }
    }

    function finishLoading() {
        console.log("Alles geladen!");
        const statusText = document.getElementById('status-text');
        statusText.innerText = "> CLICK TO INITIALIZE <";
        statusText.classList.add('blink');
        document.getElementById('progress-bar').style.display = 'none';
        document.body.style.cursor = "pointer";
        
        // Wacht op klik
        window.addEventListener('click', startGame, { once: true });
    }

    // --- 4. START ---
function startGame() {
    console.log("Start geklikt!");
    gameActive = true;
    
    // Verberg het menu
    const uiLayer = document.getElementById('ui-layer');
    if(uiLayer) uiLayer.style.display = 'none';

    // 1. STEM AFSPELEN
    // We proberen beide namen voor de zekerheid (voice_pre OF voice_pre_score)
    const voice = assets.audio['voice_pre'] || assets.audio['voice_pre_score'];
    
    if (voice) {
        console.log("Stem gevonden, afspelen...");
        voice.play();
    } else {
        console.log("Geen stem gevonden. Check de naam in assetsToLoad!");
    }

    // 2. MUZIEK AFSPELEN
// Geen ingewikkeld gedoe meer, gewoon direct de juiste naam:
const music = assets.audio['music_menu']; 

if (music) {
    music.volume = 0.5;
    music.loop = true;
    music.play();
    } else {
        console.log("Muziek NIET gevonden. De naam in de lijst is anders dan hier.");
        // Debug hulp: wat hebben we wel?
        console.log("Beschikbare audio:", Object.keys(assets.audio));
    }
}

    // --- 5. LOOP ---
    function gameLoop() {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (!gameActive) {
            requestAnimationFrame(gameLoop);
            return;
        }

        // Achtergrond
        ctx.fillStyle = "white";
        ctx.fillRect(100, 200, 2, 2);
        ctx.fillRect(500, 100, 2, 2);
        ctx.fillRect(700, 500, 2, 2);

        // Hero
        if (assets.img['hero']) {
            ctx.drawImage(assets.img['hero'], canvas.width/2 - 25, canvas.height - 100);
        } else {
            ctx.save();
            ctx.translate(canvas.width/2, canvas.height - 100);
            ctx.fillStyle = "#0f0";
            ctx.beginPath();
            ctx.moveTo(0, -20);
            ctx.lineTo(20, 20);
            ctx.lineTo(-20, 20);
            ctx.fill();
            ctx.restore();
        }

        requestAnimationFrame(gameLoop);
    }

    init();

</script>
</body>
</html>




